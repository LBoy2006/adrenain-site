# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤—ã–≥—Ä—É–∑–∫–∞ –≤ Yandex Object Storage

–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω workflow `.github/workflows/yandex-storage.yml`, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã —Å–∞–π—Ç–∞ –≤ –±–∞–∫–µ—Ç Object Storage –Ø–Ω–¥–µ–∫—Å –û–±–ª–∞–∫–∞. Workflow —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ –≤–µ—Ç–∫–∏ `main` –∏–ª–∏ `master`, –∞ —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ **Actions ‚Üí Deploy to Yandex Cloud Storage ‚Üí Run workflow**.

## –ß—Ç–æ –¥–µ–ª–∞–µ—Ç workflow

1. –ö–ª–æ–Ω–∏—Ä—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub Runner.
2. –°–æ–±–∏—Ä–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –≤ –ø–∞–ø–∫—É `dist` —Å –ø–æ–º–æ—â—å—é `rsync`, –∏—Å–∫–ª—é—á–∞—è —Å–ª—É–∂–µ–±–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (`.git`, `.github`, `.vscode`, —Å–∞–º—É –ø–∞–ø–∫—É `dist`).
3. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `dist` —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –±–∞–∫–µ—Ç–æ–º –ø—Ä–∏ –ø–æ–º–æ—â–∏ `aws s3 sync` —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ `https://storage.yandexcloud.net` –∏ —Ñ–ª–∞–≥–∞ `--delete`, —á—Ç–æ–±—ã –∏–∑ –±–∞–∫–µ—Ç–∞ —É–¥–∞–ª—è–ª–∏—Å—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Ñ–∞–π–ª—ã. –î–ª—è –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è ACL `public-read` (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å).

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –Ø–Ω–¥–µ–∫—Å –û–±–ª–∞–∫–µ

1. –°–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –∏ –≤—ã–¥–∞–π—Ç–µ –µ–º—É —Ä–æ–ª—å **storage.editor** –∏–ª–∏ –±–æ–ª–µ–µ —É–∑–∫—É—é —Ä–æ–ª—å, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—É—é –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —É–¥–∞–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –Ω—É–∂–Ω–æ–º –±–∞–∫–µ—Ç–µ.
2. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –¥–ª—è —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é –ø–∞—Ä—É –∫–ª—é—á–µ–π –¥–æ—Å—Ç—É–ø–∞ (Access key ID –∏ Secret access key).
3. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∫–µ—Ç –≤ Object Storage. –ï—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è —Ä–∞–∑–¥–∞—á–∞ —Å–∞–π—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é, –≤–∫–ª—é—á–∏—Ç–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Ö–æ—Å—Ç–∏–Ω–≥ –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –¥–æ—Å—Ç—É–ø –Ω–∞ —á—Ç–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö (–ª–∏–±–æ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –ø—Ä–∞–≤–∏–ª–æ ACL/–ø–æ–ª–∏—Ç–∏–∫—É).

## –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ GitHub

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è GitHub (**Settings ‚Üí Secrets and variables ‚Üí Actions**) –∑–∞–¥–∞–π—Ç–µ:

| –ò–º—è | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
| --- | --- | --- |
| `YANDEX_ACCESS_KEY_ID` | Secret | Access key ID —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞. |
| `YANDEX_SECRET_ACCESS_KEY` | Secret | Secret access key —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞. |
| `YANDEX_BUCKET` | Secret | –ò–º—è –±–∞–∫–µ—Ç–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Å–∞–π—Ç. |
| `YANDEX_REGION` | Secret/Variable (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | –†–µ–≥–∏–æ–Ω Object Storage. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `ru-central1`. |
| `YANDEX_ENDPOINT_URL` | Secret/Variable (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | –ö–∞—Å—Ç–æ–º–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç API, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π (`https://storage.yandexcloud.net` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é). |

> üí° –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ö—Ä–∞–Ω–∏—Ç—å —á–∞—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π –∫–∞–∫ **Variables**, –∏—Ö –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Ä–∞–∑–¥–µ–ª–µ *Repository variables* –∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –≤ workflow –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ push –≤ –≤–µ—Ç–∫—É `main` (–∏–ª–∏ `master`). Workflow –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –ª–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ä–∞–∑–¥–µ–ª–µ **Actions**. –ï—Å–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ, –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã –ø–æ—è–≤—è—Ç—Å—è –≤ –±–∞–∫–µ—Ç–µ Object Storage.

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏ –ø—Ä–∞–≤ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞.
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∫–µ—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —É –∞–∫–∫–∞—É–Ω—Ç–∞ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –Ω–∞ –∑–∞–ø–∏—Å—å/—É–¥–∞–ª–µ–Ω–∏–µ.
- –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥—Ä—É–≥–æ–π —Ä–µ–∂–∏–º –¥–æ—Å—Ç—É–ø–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–µ–∑ `public-read`), —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `aws s3 sync` –≤ workflow.
